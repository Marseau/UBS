<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Configuração WhatsApp Business</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .step-card {
            border-left: 4px solid #25D366;
            transition: all 0.3s ease;
        }
        .step-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .whatsapp-green {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
        }
        .success-box {
            background: #d1edff;
            border: 1px solid #74b9ff;
            border-radius: 8px;
            padding: 15px;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
        }
        .copy-btn:hover {
            background: #5a6268;
        }
        .tab-content {
            min-height: 600px;
        }
        .step-number {
            background: #25D366;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        .requirement-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .requirement-item i {
            color: #25D366;
            margin-right: 10px;
        }
    </style>
</head>
<body>

<!-- Modal Principal -->
<div class="modal fade" id="whatsappSetupGuide" tabindex="-1" aria-labelledby="whatsappSetupGuideLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header whatsapp-green text-white">
                <h5 class="modal-title" id="whatsappSetupGuideLabel">
                    <i class="fab fa-whatsapp me-2"></i>
                    Guia Completo - WhatsApp Business API
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
                
                <!-- Navegação por Abas -->
                <nav>
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-overview-tab" data-bs-toggle="tab" data-bs-target="#nav-overview" type="button">
                            <i class="fas fa-info-circle me-1"></i>Visão Geral
                        </button>
                        <button class="nav-link" id="nav-requirements-tab" data-bs-toggle="tab" data-bs-target="#nav-requirements" type="button">
                            <i class="fas fa-list-check me-1"></i>Pré-requisitos
                        </button>
                        <button class="nav-link" id="nav-business-account-tab" data-bs-toggle="tab" data-bs-target="#nav-business-account" type="button">
                            <i class="fas fa-building me-1"></i>Conta Business
                        </button>
                        <button class="nav-link" id="nav-app-creation-tab" data-bs-toggle="tab" data-bs-target="#nav-app-creation" type="button">
                            <i class="fas fa-code me-1"></i>Criar App
                        </button>
                        <button class="nav-link" id="nav-credentials-tab" data-bs-toggle="tab" data-bs-target="#nav-credentials" type="button">
                            <i class="fas fa-key me-1"></i>Credenciais
                        </button>
                        <button class="nav-link" id="nav-configuration-tab" data-bs-toggle="tab" data-bs-target="#nav-configuration" type="button">
                            <i class="fas fa-cog me-1"></i>Configuração
                        </button>
                        <button class="nav-link" id="nav-testing-tab" data-bs-toggle="tab" data-bs-target="#nav-testing" type="button">
                            <i class="fas fa-vial me-1"></i>Testes
                        </button>
                    </div>
                </nav>

                <!-- Conteúdo das Abas -->
                <div class="tab-content p-4" id="nav-tabContent">
                    
                    <!-- ABA 1: VISÃO GERAL -->
                    <div class="tab-pane fade show active" id="nav-overview" role="tabpanel">
                        <div class="row">
                            <div class="col-md-8">
                                <h4 class="text-success mb-3">
                                    <i class="fab fa-whatsapp me-2"></i>WhatsApp Business API
                                </h4>
                                <p class="lead">Integre seu negócio com o WhatsApp Business API oficial para receber agendamentos automaticamente.</p>
                                
                                <div class="row g-3 mb-4">
                                    <div class="col-md-6">
                                        <div class="card h-100 step-card">
                                            <div class="card-body">
                                                <h6 class="card-title text-success">
                                                    <i class="fas fa-robot me-2"></i>Automação Inteligente
                                                </h6>
                                                <p class="card-text small">IA responde automaticamente, confirma horários e gerencia agendamentos via WhatsApp.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100 step-card">
                                            <div class="card-body">
                                                <h6 class="card-title text-success">
                                                    <i class="fas fa-shield-alt me-2"></i>Oficial & Seguro
                                                </h6>
                                                <p class="card-text small">API oficial do WhatsApp com verificação business e selo verde de confiança.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100 step-card">
                                            <div class="card-body">
                                                <h6 class="card-title text-success">
                                                    <i class="fas fa-chart-line me-2"></i>Analytics Completo
                                                </h6>
                                                <p class="card-text small">Métricas detalhadas de conversas, agendamentos e performance do negócio.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100 step-card">
                                            <div class="card-body">
                                                <h6 class="card-title text-success">
                                                    <i class="fas fa-images me-2"></i>Multimídia
                                                </h6>
                                                <p class="card-text small">Envie e receba imagens, áudios, documentos e mensagens interativas.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="success-box">
                                    <h6><i class="fas fa-lightbulb me-2"></i>Por que usar WhatsApp Business API?</h6>
                                    <ul class="mb-0">
                                        <li><strong>96% dos brasileiros</strong> usam WhatsApp diariamente</li>
                                        <li><strong>70% preferem</strong> agendar serviços via WhatsApp</li>
                                        <li><strong>85% de taxa de abertura</strong> vs 20% do email</li>
                                        <li><strong>Resposta em tempo real</strong> 24/7 com IA</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fas fa-clock me-2"></i>Tempo Estimado</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>Configuração inicial:</span>
                                            <span class="badge bg-success">15-30 min</span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>Aprovação Facebook:</span>
                                            <span class="badge bg-warning">1-3 dias</span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <span>Testes e ajustes:</span>
                                            <span class="badge bg-info">30 min</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mt-3">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fas fa-dollar-sign me-2"></i>Custos</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>WhatsApp Business API:</span>
                                            <span class="text-success"><strong>GRATUITO</strong></span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>Mensagens (1000/mês):</span>
                                            <span class="text-success"><strong>GRATUITO</strong></span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <span>Templates de notificação:</span>
                                            <span class="text-muted">~R$ 0,05 cada</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 2: PRÉ-REQUISITOS -->
                    <div class="tab-pane fade" id="nav-requirements" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-list-check me-2"></i>Pré-requisitos Obrigatórios
                        </h4>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card step-card h-100">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fas fa-building me-2"></i>Empresa & Documentação</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>CNPJ ativo</strong> (pessoa jurídica obrigatória)</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Website oficial</strong> do negócio</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Política de Privacidade</strong> publicada</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Termos de Uso</strong> acessíveis</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Endereço comercial</strong> verificável</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card step-card h-100">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fas fa-phone me-2"></i>Número WhatsApp</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Número exclusivo</strong> para API</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Não usado</strong> no WhatsApp normal</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Acesso ao SMS</strong> para verificação</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Vinculado ao CNPJ</strong> (plano empresarial)</span>
                                        </div>
                                        
                                        <div class="warning-box mt-3">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            <strong>Importante:</strong> O número não pode estar em uso no WhatsApp pessoal ou Business normal.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card step-card h-100">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fab fa-facebook me-2"></i>Conta Facebook</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Facebook Business Manager</strong> criado</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Página comercial</strong> verificada</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Perfil administrativo</strong> completo</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Histórico limpo</strong> (sem violações)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card step-card h-100">
                                    <div class="card-header bg-light">
                                        <h6 class="mb-0"><i class="fas fa-server me-2"></i>Técnico</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Domínio HTTPS</strong> válido</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Webhook endpoint</strong> configurado</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle"></i>
                                            <span><strong>Certificado SSL</strong> ativo</span>
                                        </div>
                                        <div class="requirement-item">
                                            <i class="fas fa-check-circle text-success"></i>
                                            <span><strong>UBS já configurado</strong> ✓</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 3: CONTA BUSINESS -->
                    <div class="tab-pane fade" id="nav-business-account" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-building me-2"></i>Criar WhatsApp Business Account
                        </h4>

                        <div class="row">
                            <div class="col-md-8">
                                <!-- Passo 1 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">1</div>
                                            <div class="flex-grow-1">
                                                <h6>Acesse o WhatsApp Business</h6>
                                                <p class="mb-2">Vá para o site oficial do WhatsApp Business:</p>
                                                <div class="code-block position-relative">
                                                    <button class="copy-btn" onclick="copyToClipboard('https://business.whatsapp.com/')">Copiar</button>
                                                    https://business.whatsapp.com/
                                                </div>
                                                <p class="text-muted small mt-2">Clique em "Get Started" para começar o processo.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 2 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">2</div>
                                            <div class="flex-grow-1">
                                                <h6>Faça Login no Facebook</h6>
                                                <p class="mb-2">Use a conta Facebook que será responsável pela empresa:</p>
                                                <ul class="small">
                                                    <li>Deve ter permissões administrativas</li>
                                                    <li>Conta verificada e em boa situação</li>
                                                    <li>Vinculada ao Facebook Business Manager</li>
                                                </ul>
                                                <div class="warning-box">
                                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                                    <strong>Importante:</strong> Esta conta Facebook será o administrador principal do WhatsApp Business.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 3 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">3</div>
                                            <div class="flex-grow-1">
                                                <h6>Adicionar Número de Telefone</h6>
                                                <p class="mb-2">Configure o número que será usado para a API:</p>
                                                <ul class="small">
                                                    <li><strong>Formato:</strong> +55 (xx) 9xxxx-xxxx</li>
                                                    <li><strong>Verificação:</strong> SMS ou chamada</li>
                                                    <li><strong>Exclusividade:</strong> Não pode estar em uso em outro WhatsApp</li>
                                                </ul>
                                                <div class="success-box">
                                                    <i class="fas fa-info-circle me-2"></i>
                                                    <strong>Dica:</strong> Você receberá um SMS com código de 6 dígitos para verificação.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 4 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">4</div>
                                            <div class="flex-grow-1">
                                                <h6>Verificação da Empresa</h6>
                                                <p class="mb-2">Forneça informações da empresa para verificação:</p>
                                                <ul class="small">
                                                    <li><strong>Nome da empresa</strong> (conforme CNPJ)</li>
                                                    <li><strong>Categoria do negócio</strong> (ex: Salão de Beleza)</li>
                                                    <li><strong>Website oficial</strong> (domínio próprio)</li>
                                                    <li><strong>Endereço comercial</strong> completo</li>
                                                    <li><strong>Documento CNPJ</strong> (PDF ou imagem)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-shield-alt me-2"></i>Processo de Aprovação</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="timeline">
                                            <div class="d-flex mb-3">
                                                <div class="badge bg-success rounded-pill me-2">1</div>
                                                <div>
                                                    <small class="text-muted">Envio dos dados</small>
                                                    <div class="fw-bold">Imediato</div>
                                                </div>
                                            </div>
                                            <div class="d-flex mb-3">
                                                <div class="badge bg-warning rounded-pill me-2">2</div>
                                                <div>
                                                    <small class="text-muted">Análise Facebook</small>
                                                    <div class="fw-bold">1-3 dias úteis</div>
                                                </div>
                                            </div>
                                            <div class="d-flex mb-3">
                                                <div class="badge bg-info rounded-pill me-2">3</div>
                                                <div>
                                                    <small class="text-muted">Verificação empresa</small>
                                                    <div class="fw-bold">2-5 dias úteis</div>
                                                </div>
                                            </div>
                                            <div class="d-flex">
                                                <div class="badge bg-success rounded-pill me-2">4</div>
                                                <div>
                                                    <small class="text-muted">Aprovação final</small>
                                                    <div class="fw-bold">Automática</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mt-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="mb-0"><i class="fas fa-clock me-2"></i>Aguardando Aprovação?</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-2">Durante a análise você pode:</p>
                                        <ul class="small">
                                            <li>Continuar configurando o app</li>
                                            <li>Preparar webhooks</li>
                                            <li>Configurar templates</li>
                                            <li>Fazer testes em sandbox</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 4: CRIAR APP -->
                    <div class="tab-pane fade" id="nav-app-creation" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-code me-2"></i>Criar App no Facebook Developers
                        </h4>

                        <div class="row">
                            <div class="col-md-8">
                                <!-- Passo 1 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">1</div>
                                            <div class="flex-grow-1">
                                                <h6>Acesse o Facebook Developers</h6>
                                                <p class="mb-2">Vá para o portal de desenvolvedores:</p>
                                                <div class="code-block position-relative">
                                                    <button class="copy-btn" onclick="copyToClipboard('https://developers.facebook.com/')">Copiar</button>
                                                    https://developers.facebook.com/
                                                </div>
                                                <p class="text-muted small mt-2">Faça login com a mesma conta Facebook usada no WhatsApp Business.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 2 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">2</div>
                                            <div class="flex-grow-1">
                                                <h6>Criar Novo App</h6>
                                                <p class="mb-2">Clique em "Create App" e configure:</p>
                                                <ul class="small">
                                                    <li><strong>Tipo:</strong> "Business" (não escolha "Consumer")</li>
                                                    <li><strong>Nome do App:</strong> Nome da sua empresa + "WhatsApp"</li>
                                                    <li><strong>Email de contato:</strong> Email oficial da empresa</li>
                                                    <li><strong>Business Manager:</strong> Selecione sua conta business</li>
                                                </ul>
                                                <div class="success-box">
                                                    <i class="fas fa-lightbulb me-2"></i>
                                                    <strong>Exemplo:</strong> "Salão Bella Vista WhatsApp" como nome do app.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 3 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">3</div>
                                            <div class="flex-grow-1">
                                                <h6>Adicionar WhatsApp Business Platform</h6>
                                                <p class="mb-2">No dashboard do app, adicione o produto WhatsApp:</p>
                                                <ul class="small">
                                                    <li>Procure por "WhatsApp" na lista de produtos</li>
                                                    <li>Clique em "Set up" no card "WhatsApp Business Platform"</li>
                                                    <li>Selecione "Business" como tipo de integração</li>
                                                    <li>Aceite os termos de uso</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Passo 4 -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <div class="step-number">4</div>
                                            <div class="flex-grow-1">
                                                <h6>Configurar Webhook</h6>
                                                <p class="mb-2">Configure o endpoint que receberá as mensagens:</p>
                                                <div class="code-block position-relative">
                                                    <button class="copy-btn" onclick="copyToClipboard('https://seu-dominio.com.br/api/whatsapp/webhook')">Copiar</button>
                                                    <strong>Callback URL:</strong><br>
                                                    https://seu-dominio.com.br/api/whatsapp/webhook
                                                </div>
                                                <div class="code-block position-relative mt-2">
                                                    <button class="copy-btn" onclick="copyToClipboard('UBS_WEBHOOK_2024_SECURE')">Copiar</button>
                                                    <strong>Verify Token:</strong><br>
                                                    UBS_WEBHOOK_2024_SECURE
                                                </div>
                                                <div class="warning-box mt-2">
                                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                                    <strong>Importante:</strong> Substitua "seu-dominio.com.br" pelo seu domínio real.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0"><i class="fas fa-cog me-2"></i>Webhook Events</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-2">Marque estes eventos no webhook:</p>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" checked disabled>
                                            <label class="form-check-label small">messages</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" checked disabled>
                                            <label class="form-check-label small">message_deliveries</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" checked disabled>
                                            <label class="form-check-label small">message_reads</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" checked disabled>
                                            <label class="form-check-label small">message_status</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mt-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="mb-0"><i class="fas fa-key me-2"></i>App Review</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="small">Para produção, solicite aprovação para:</p>
                                        <ul class="small">
                                            <li>whatsapp_business_messaging</li>
                                            <li>whatsapp_business_management</li>
                                        </ul>
                                        <p class="small text-muted">Pode demorar 1-2 semanas.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 5: CREDENCIAIS -->
                    <div class="tab-pane fade" id="nav-credentials" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-key me-2"></i>Obter Credenciais da API
                        </h4>

                        <div class="row">
                            <div class="col-md-8">
                                <!-- Access Token -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-lock me-2"></i>1. Access Token</h6>
                                        <p class="mb-2">No painel do WhatsApp Business Platform:</p>
                                        <ol class="small">
                                            <li>Vá para "WhatsApp" → "API Setup"</li>
                                            <li>Na seção "Temporary access token"</li>
                                            <li>Clique em "Copy" para copiar o token</li>
                                            <li>Este token é temporário (24h)</li>
                                        </ol>
                                        <div class="code-block position-relative">
                                            <strong>Formato do Access Token:</strong><br>
                                            EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                        </div>
                                        <div class="warning-box mt-2">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            <strong>Token Temporário:</strong> Substitua por token permanente antes de produção.
                                        </div>
                                    </div>
                                </div>

                                <!-- Phone Number ID -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-phone me-2"></i>2. Phone Number ID</h6>
                                        <p class="mb-2">Na mesma tela "API Setup":</p>
                                        <ol class="small">
                                            <li>Procure a seção "From"</li>
                                            <li>Copie o "Phone number ID" (não o número em si)</li>
                                            <li>Este ID identifica seu número na API</li>
                                        </ol>
                                        <div class="code-block position-relative">
                                            <strong>Formato do Phone Number ID:</strong><br>
                                            123456789012345
                                        </div>
                                    </div>
                                </div>

                                <!-- Business Account ID -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-building me-2"></i>3. Business Account ID</h6>
                                        <p class="mb-2">No Facebook Business Manager:</p>
                                        <ol class="small">
                                            <li>Vá para "Business Settings"</li>
                                            <li>Clique em "Business Info"</li>
                                            <li>Copie o "Business ID"</li>
                                            <li>Ou encontre na URL do Business Manager</li>
                                        </ol>
                                        <div class="code-block position-relative">
                                            <strong>Formato do Business Account ID:</strong><br>
                                            987654321098765
                                        </div>
                                    </div>
                                </div>

                                <!-- Token Permanente -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-warning"><i class="fas fa-infinity me-2"></i>4. Token Permanente (Recomendado)</h6>
                                        <p class="mb-2">Para produção, gere um token permanente:</p>
                                        <ol class="small">
                                            <li>No app: "WhatsApp" → "Configuration"</li>
                                            <li>Gere um "System User Access Token"</li>
                                            <li>Selecione as permissões: whatsapp_business_messaging</li>
                                            <li>Token nunca expira (até ser revogado)</li>
                                        </ol>
                                        <div class="success-box">
                                            <i class="fas fa-shield-alt me-2"></i>
                                            <strong>Produção:</strong> Sempre use token permanente para evitar interrupções.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-clipboard-list me-2"></i>Checklist Credenciais</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="check1">
                                            <label class="form-check-label small" for="check1">
                                                Access Token copiado
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="check2">
                                            <label class="form-check-label small" for="check2">
                                                Phone Number ID copiado
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="check3">
                                            <label class="form-check-label small" for="check3">
                                                Business Account ID obtido
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="check4">
                                            <label class="form-check-label small" for="check4">
                                                Webhook configurado
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="check5">
                                            <label class="form-check-label small" for="check5">
                                                Token permanente gerado
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mt-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="mb-0"><i class="fas fa-eye-slash me-2"></i>Segurança</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>Nunca compartilhe</strong> tokens</li>
                                            <li><strong>Use HTTPS</strong> sempre</li>
                                            <li><strong>Rotacione tokens</strong> periodicamente</li>
                                            <li><strong>Monitore uso</strong> da API</li>
                                            <li><strong>Configure alertas</strong> de segurança</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 6: CONFIGURAÇÃO -->
                    <div class="tab-pane fade" id="nav-configuration" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-cog me-2"></i>Configurar no UBS
                        </h4>

                        <div class="row">
                            <div class="col-md-8">
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-form me-2"></i>Preenchimento do Formulário</h6>
                                        <p class="mb-3">Cole as credenciais obtidas nos campos correspondentes:</p>
                                        
                                        <div class="form-group mb-3">
                                            <label class="form-label fw-bold">Número do WhatsApp</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" placeholder="+55 11 99999-9999" id="demo-phone">
                                                <button class="btn btn-outline-secondary" onclick="copyToField('demo-phone', '+55 11 99999-9999')">
                                                    <i class="fas fa-paste"></i>
                                                </button>
                                            </div>
                                            <div class="form-text">Número verificado no WhatsApp Business (com código do país)</div>
                                        </div>

                                        <div class="form-group mb-3">
                                            <label class="form-label fw-bold">Business Account ID</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" placeholder="123456789012345" id="demo-business-id">
                                                <button class="btn btn-outline-secondary" onclick="copyToField('demo-business-id', '123456789012345')">
                                                    <i class="fas fa-paste"></i>
                                                </button>
                                            </div>
                                            <div class="form-text">ID da conta comercial do Facebook Business Manager</div>
                                        </div>

                                        <div class="form-group mb-3">
                                            <label class="form-label fw-bold">Access Token</label>
                                            <div class="input-group">
                                                <input type="password" class="form-control" placeholder="EAAxxxxxxxxxxxxxxxxxxxxx" id="demo-token">
                                                <button class="btn btn-outline-secondary" onclick="togglePassword('demo-token')">
                                                    <i class="fas fa-eye" id="demo-token-icon"></i>
                                                </button>
                                            </div>
                                            <div class="form-text">Token de acesso permanente da API do WhatsApp</div>
                                        </div>

                                        <div class="success-box">
                                            <h6><i class="fas fa-lightbulb me-2"></i>Dicas de Preenchimento:</h6>
                                            <ul class="mb-0 small">
                                                <li><strong>Número:</strong> Sempre inclua o código do país (+55 para Brasil)</li>
                                                <li><strong>Business ID:</strong> Número longo de 15 dígitos</li>
                                                <li><strong>Token:</strong> Começa com "EAA" e tem ~200 caracteres</li>
                                                <li><strong>Phone Number ID:</strong> Será detectado automaticamente</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <div class="card step-card">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-save me-2"></i>Salvar e Conectar</h6>
                                        <p class="mb-3">Após preencher todos os campos:</p>
                                        <ol class="small">
                                            <li>Clique em <strong>"Conectar WhatsApp"</strong></li>
                                            <li>Sistema verificará as credenciais automaticamente</li>
                                            <li>Se tudo estiver correto, status mudará para "Conectado"</li>
                                            <li>Clique em <strong>"Testar Conexão"</strong> para confirmar</li>
                                        </ol>
                                        
                                        <div class="d-flex gap-2 mt-3">
                                            <button class="btn btn-success">
                                                <i class="fas fa-plug me-2"></i>Conectar WhatsApp
                                            </button>
                                            <button class="btn btn-outline-success">
                                                <i class="fas fa-vial me-2"></i>Testar Conexão
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0"><i class="fas fa-question-circle me-2"></i>Problemas Comuns</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="accordion accordion-flush" id="troubleshootingAccordion">
                                            <div class="accordion-item">
                                                <h6 class="accordion-header">
                                                    <button class="accordion-button collapsed small" type="button" data-bs-toggle="collapse" data-bs-target="#trouble1">
                                                        Erro "Invalid access token"
                                                    </button>
                                                </h6>
                                                <div id="trouble1" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                                    <div class="accordion-body small">
                                                        • Token expirado (use permanente)<br>
                                                        • Copiou com espaços extras<br>
                                                        • App não tem permissões WhatsApp
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h6 class="accordion-header">
                                                    <button class="accordion-button collapsed small" type="button" data-bs-toggle="collapse" data-bs-target="#trouble2">
                                                        Erro "Phone number not found"
                                                    </button>
                                                </h6>
                                                <div id="trouble2" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                                    <div class="accordion-body small">
                                                        • Número não verificado no WhatsApp Business<br>
                                                        • Formato incorreto do número<br>
                                                        • Aguardar aprovação Facebook
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="accordion-item">
                                                <h6 class="accordion-header">
                                                    <button class="accordion-button collapsed small" type="button" data-bs-toggle="collapse" data-bs-target="#trouble3">
                                                        Webhook não recebe mensagens
                                                    </button>
                                                </h6>
                                                <div id="trouble3" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                                    <div class="accordion-body small">
                                                        • URL webhook incorreta<br>
                                                        • Certificado SSL inválido<br>
                                                        • Verify token diferente<br>
                                                        • Firewall bloqueando Facebook
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ABA 7: TESTES -->
                    <div class="tab-pane fade" id="nav-testing" role="tabpanel">
                        <h4 class="text-success mb-4">
                            <i class="fas fa-vial me-2"></i>Testar Integração
                        </h4>

                        <div class="row">
                            <div class="col-md-8">
                                <!-- Teste 1: Envio de Mensagem -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-paper-plane me-2"></i>1. Teste de Envio</h6>
                                        <p class="mb-2">Teste o envio de mensagem pelo UBS:</p>
                                        <ol class="small">
                                            <li>Clique em "Testar Conexão" nas configurações</li>
                                            <li>Informe um número de telefone válido</li>
                                            <li>Sistema enviará mensagem de teste</li>
                                            <li>Verifique o recebimento no WhatsApp</li>
                                        </ol>
                                        <div class="code-block">
                                            <strong>Mensagem de teste esperada:</strong><br>
                                            🎯 Olá! Este é um teste de conexão do UBS (Universal Booking System). Sua integração WhatsApp está funcionando perfeitamente! ✅
                                        </div>
                                    </div>
                                </div>

                                <!-- Teste 2: Recebimento -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-inbox me-2"></i>2. Teste de Recebimento</h6>
                                        <p class="mb-2">Teste o recebimento de mensagens:</p>
                                        <ol class="small">
                                            <li>Envie uma mensagem WhatsApp para o número configurado</li>
                                            <li>Exemplo: "Olá, gostaria de agendar um corte"</li>
                                            <li>IA deve responder automaticamente</li>
                                            <li>Verifique na aba "Conversas" do UBS</li>
                                        </ol>
                                        <div class="success-box">
                                            <i class="fas fa-robot me-2"></i>
                                            <strong>Resposta esperada da IA:</strong> Mensagem inteligente com opções de agendamento e horários disponíveis.
                                        </div>
                                    </div>
                                </div>

                                <!-- Teste 3: Agendamento -->
                                <div class="card step-card mb-3">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-calendar-check me-2"></i>3. Teste de Agendamento</h6>
                                        <p class="mb-2">Simule um agendamento completo:</p>
                                        <ol class="small">
                                            <li>Inicie conversa: "Quero agendar um corte de cabelo"</li>
                                            <li>IA oferecerá horários disponíveis</li>
                                            <li>Escolha um horário: "Amanhã às 14:00"</li>
                                            <li>Confirme os dados quando solicitado</li>
                                            <li>Verifique o agendamento na aba "Agendamentos"</li>
                                        </ol>
                                    </div>
                                </div>

                                <!-- Teste 4: Mídia -->
                                <div class="card step-card">
                                    <div class="card-body">
                                        <h6 class="text-success"><i class="fas fa-image me-2"></i>4. Teste de Mídia</h6>
                                        <p class="mb-2">Teste envio de imagens e áudios:</p>
                                        <ol class="small">
                                            <li>Envie uma foto com texto: "Como fica este corte?"</li>
                                            <li>IA analisará a imagem automaticamente</li>
                                            <li>Envie um áudio perguntando sobre serviços</li>
                                            <li>IA transcreverá e responderá o áudio</li>
                                        </ol>
                                        <div class="warning-box">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <strong>Nota:</strong> Processamento de mídia pode levar alguns segundos.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-check-double me-2"></i>Checklist de Testes</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="test1">
                                            <label class="form-check-label small" for="test1">
                                                Mensagem enviada com sucesso
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="test2">
                                            <label class="form-check-label small" for="test2">
                                                Mensagem recebida e processada
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="test3">
                                            <label class="form-check-label small" for="test3">
                                                IA respondeu automaticamente
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="test4">
                                            <label class="form-check-label small" for="test4">
                                                Agendamento criado no sistema
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="test5">
                                            <label class="form-check-label small" for="test5">
                                                Imagem processada pela IA
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="test6">
                                            <label class="form-check-label small" for="test6">
                                                Áudio transcrito corretamente
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mt-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="mb-0"><i class="fas fa-tools me-2"></i>Ferramentas de Debug</h6>
                                    </div>
                                    <div class="card-body">
                                        <button class="btn btn-outline-primary btn-sm w-100 mb-2">
                                            <i class="fas fa-bug me-2"></i>Ver Logs da API
                                        </button>
                                        <button class="btn btn-outline-info btn-sm w-100 mb-2">
                                            <i class="fas fa-chart-line me-2"></i>Métricas WhatsApp
                                        </button>
                                        <button class="btn btn-outline-success btn-sm w-100">
                                            <i class="fas fa-history me-2"></i>Histórico de Conversas
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <div class="me-auto">
                    <span class="badge bg-success">
                        <i class="fas fa-headset me-1"></i>Suporte 24/7 disponível
                    </span>
                </div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-success" onclick="goToWhatsAppSettings()">
                    <i class="fas fa-cog me-2"></i>Ir para Configurações
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Função para copiar texto para clipboard
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            // Feedback visual
            const event = new CustomEvent('showToast', { 
                detail: { message: 'Copiado para área de transferência!', type: 'success' } 
            });
            document.dispatchEvent(event);
        });
    }

    // Função para copiar para campo de input
    function copyToField(fieldId, text) {
        const field = document.getElementById(fieldId);
        field.value = text;
        field.select();
        document.execCommand('copy');
    }

    // Função para mostrar/ocultar senha
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = document.getElementById(fieldId + '-icon');
        
        if (field.type === 'password') {
            field.type = 'text';
            icon.className = 'fas fa-eye-slash';
        } else {
            field.type = 'password';
            icon.className = 'fas fa-eye';
        }
    }

    // Função para ir para configurações
    function goToWhatsAppSettings() {
        // Fechar modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('whatsappSetupGuide'));
        modal.hide();
        
        // Redirecionar ou fazer scroll para seção WhatsApp
        if (typeof scrollToWhatsAppSection === 'function') {
            scrollToWhatsAppSection();
        } else {
            // Fallback: recarregar página com hash
            window.location.hash = '#whatsapp-section';
            window.location.reload();
        }
    }

    // Event listener para mostrar modal automaticamente se necessário
    document.addEventListener('DOMContentLoaded', function() {
        // Verificar se deve mostrar o guia automaticamente
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('whatsapp-guide') === 'true') {
            const modal = new bootstrap.Modal(document.getElementById('whatsappSetupGuide'));
            modal.show();
        }
    });

    // Toast notification system
    document.addEventListener('showToast', function(e) {
        const { message, type = 'info' } = e.detail;
        
        // Criar toast element se não existir
        let toastContainer = document.getElementById('toast-container');
        if (!toastContainer) {
            toastContainer = document.createElement('div');
            toastContainer.id = 'toast-container';
            toastContainer.className = 'position-fixed top-0 end-0 p-3';
            toastContainer.style.zIndex = '9999';
            document.body.appendChild(toastContainer);
        }
        
        // Criar toast
        const toastElement = document.createElement('div');
        toastElement.className = `toast show align-items-center text-bg-${type} border-0`;
        toastElement.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        `;
        
        toastContainer.appendChild(toastElement);
        
        // Auto-remover após 3 segundos
        setTimeout(() => {
            toastElement.remove();
        }, 3000);
    });
</script>

</body>
</html>