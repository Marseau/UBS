{
  "timestamp": "2025-08-09T13:58:25.738Z",
  "availableTables": [
    "tenants",
    "user_tenants",
    "users",
    "appointments",
    "services",
    "professionals",
    "tenant_metrics",
    "platform_metrics",
    "conversation_history",
    "subscription_payments"
  ],
  "tableStructures": {
    "tenants": {
      "columns": [
        "id",
        "name",
        "slug",
        "business_name",
        "business_description",
        "domain",
        "email",
        "phone",
        "whatsapp_phone",
        "business_address",
        "status",
        "subscription_plan",
        "ai_settings",
        "domain_config",
        "business_rules",
        "created_at",
        "updated_at",
        "monthly_subscription_fee",
        "plan_type",
        "billing_cycle_day",
        "subscription_status",
        "subscription_start_date"
      ],
      "sampleRow": {
        "id": "33b8c488-5aa9-4891-b335-701d10296681",
        "name": "Bella Vista Spa",
        "slug": "bella-vista-spa",
        "business_name": "Bella Vista Spa & Salon",
        "business_description": null,
        "domain": "beauty",
        "email": "contato@bellavistaspa.com",
        "phone": "+5511987654320",
        "whatsapp_phone": null,
        "business_address": null,
        "status": "active",
        "subscription_plan": "profissional",
        "ai_settings": {
          "upsell_enabled": false,
          "domain_keywords": [],
          "greeting_message": "Olá! Como posso ajudá-lo hoje?",
          "sensitive_topics": [],
          "escalation_triggers": [],
          "motivational_messages": false
        },
        "domain_config": {},
        "business_rules": {
          "working_hours": {
            "friday": [],
            "monday": [],
            "sunday": [],
            "tuesday": [],
            "saturday": [],
            "thursday": [],
            "wednesday": []
          },
          "loyalty_program": false,
          "payment_methods": [
            "cash",
            "card"
          ],
          "package_discounts": false,
          "cancellation_policy": "24 hours notice required",
          "travel_time_minutes": 0,
          "advance_booking_days": 30,
          "peak_hours_surcharge": 0
        },
        "created_at": "2025-06-15T00:27:52.691425+00:00",
        "updated_at": "2025-07-30T00:27:52.691425+00:00",
        "monthly_subscription_fee": 79.9,
        "plan_type": "standard",
        "billing_cycle_day": 1,
        "subscription_status": "active",
        "subscription_start_date": "2025-07-29"
      },
      "hasData": true
    },
    "user_tenants": {
      "columns": [
        "user_id",
        "tenant_id",
        "role",
        "tenant_preferences",
        "first_interaction",
        "last_interaction",
        "total_bookings",
        "preferred_professional_id"
      ],
      "sampleRow": {
        "user_id": "00ffbb8b-fa1e-4678-b513-9ae0e21886b3",
        "tenant_id": "85cee693-a2e2-444a-926a-19f69db13489",
        "role": "customer",
        "tenant_preferences": {
          "reminders": true,
          "preferred_time": "morning",
          "communication_method": "whatsapp"
        },
        "first_interaction": "2025-07-10T00:00:43.513429+00:00",
        "last_interaction": "2025-07-29T00:00:43.513429+00:00",
        "total_bookings": 5,
        "preferred_professional_id": null
      },
      "hasData": true
    },
    "users": {
      "columns": [
        "id",
        "phone",
        "name",
        "email",
        "preferences",
        "created_at",
        "updated_at",
        "address",
        "birth_date",
        "gender",
        "emergency_contact"
      ],
      "sampleRow": {
        "id": "e905aacb-ffce-432d-b4e5-343aaee52de8",
        "phone": "+551190000000",
        "name": "João Silva",
        "email": "joão.silva0@email.com",
        "preferences": {},
        "created_at": "2025-06-05T14:52:54.72+00:00",
        "updated_at": "2025-07-29T23:14:54.762926+00:00",
        "address": {},
        "birth_date": null,
        "gender": null,
        "emergency_contact": {}
      },
      "hasData": true
    },
    "appointments": {
      "columns": [
        "id",
        "tenant_id",
        "user_id",
        "professional_id",
        "service_id",
        "start_time",
        "end_time",
        "timezone",
        "status",
        "quoted_price",
        "final_price",
        "currency",
        "appointment_data",
        "customer_notes",
        "internal_notes",
        "external_event_id",
        "cancelled_at",
        "cancelled_by",
        "cancellation_reason",
        "created_at",
        "updated_at"
      ],
      "sampleRow": {
        "id": "e973d416-43d5-4473-adbc-153ec80e2479",
        "tenant_id": "c3aa73f8-db80-40db-a9c4-73718a0fee34",
        "user_id": "4714a206-1ea7-44bc-adea-c5f4485ec964",
        "professional_id": "468fcc4f-6b9d-47a5-a3ec-dc87f6f99d5e",
        "service_id": "3fcdd181-2e1d-4d34-84c3-18e5dd2cd347",
        "start_time": "2025-08-10T18:30:00+00:00",
        "end_time": "2025-08-10T19:30:00+00:00",
        "timezone": "America/Sao_Paulo",
        "status": "confirmed",
        "quoted_price": 122,
        "final_price": null,
        "currency": "BRL",
        "appointment_data": {
          "source": "google_calendar",
          "import_source": "webhook_simulation",
          "tenant_domain": "education",
          "booking_method": "external_sync",
          "calendar_event": {
            "event_url": "https://calendar.google.com/event?eid=gcal_1753880681848_0_22nyk0qa",
            "calendar_id": "primary",
            "imported_at": "2025-07-30T13:04:41.849Z",
            "sync_status": "imported",
            "original_event": {
              "creator": "cliente856@exemplo.com",
              "summary": "Aula Particular",
              "location": "Centro Educacional Futuro",
              "description": "Aula Particular - Agendado externamente via Google Calendar"
            },
            "webhook_triggered": true
          },
          "professional_name": "Prof. Nathan"
        },
        "customer_notes": "Evento importado do Google Calendar: Aula Particular",
        "internal_notes": null,
        "external_event_id": "gcal_1753880681848_0_22nyk0qa",
        "cancelled_at": null,
        "cancelled_by": null,
        "cancellation_reason": null,
        "created_at": "2025-07-30T13:04:41.893114+00:00",
        "updated_at": "2025-07-30T13:04:41.893114+00:00"
      },
      "hasData": true
    },
    "services": {
      "columns": [
        "id",
        "tenant_id",
        "category_id",
        "name",
        "description",
        "duration_type",
        "duration_minutes",
        "duration_min",
        "duration_max",
        "price_model",
        "base_price",
        "currency",
        "service_config",
        "is_active",
        "display_order",
        "advance_booking_days",
        "max_bookings_per_day",
        "created_at",
        "updated_at"
      ],
      "sampleRow": {
        "id": "15df8115-f763-4deb-aa84-c8c2651d2c77",
        "tenant_id": "33b8c488-5aa9-4891-b335-701d10296681",
        "category_id": "03891d64-4efb-45cd-82bf-971286d97778",
        "name": "Coloração",
        "description": null,
        "duration_type": "fixed",
        "duration_minutes": 120,
        "duration_min": null,
        "duration_max": null,
        "price_model": "fixed",
        "base_price": 102.02,
        "currency": "BRL",
        "service_config": {},
        "is_active": true,
        "display_order": 0,
        "advance_booking_days": null,
        "max_bookings_per_day": null,
        "created_at": "2025-07-29T23:34:19.853694+00:00",
        "updated_at": "2025-07-30T18:56:13.610593+00:00"
      },
      "hasData": true
    },
    "professionals": {
      "columns": [
        "id",
        "tenant_id",
        "name",
        "email",
        "phone",
        "specialties",
        "bio",
        "avatar_url",
        "is_active",
        "working_hours",
        "created_at",
        "updated_at",
        "google_calendar_credentials",
        "google_calendar_id"
      ],
      "sampleRow": {
        "id": "bb095316-755c-4ee4-a5b8-8549108b418c",
        "tenant_id": "33b8c488-5aa9-4891-b335-701d10296681",
        "name": "Mínimo",
        "email": null,
        "phone": null,
        "specialties": null,
        "bio": null,
        "avatar_url": null,
        "is_active": true,
        "working_hours": {
          "friday": [],
          "monday": [],
          "sunday": [],
          "tuesday": [],
          "saturday": [],
          "thursday": [],
          "wednesday": []
        },
        "created_at": "2025-07-29T23:22:35.445972+00:00",
        "updated_at": "2025-07-29T23:22:35.445972+00:00",
        "google_calendar_credentials": null,
        "google_calendar_id": "primary"
      },
      "hasData": true
    },
    "tenant_metrics": {
      "columns": [
        "id",
        "tenant_id",
        "metric_type",
        "metric_data",
        "period",
        "calculated_at",
        "created_at",
        "updated_at",
        "metricas_validadas"
      ],
      "sampleRow": {
        "id": "f3c10c1b-864a-49e2-a8e1-8f1b596b1bd2",
        "tenant_id": "85cee693-a2e2-444a-926a-19f69db13489",
        "metric_type": "comprehensive",
        "metric_data": {
          "period": "7d",
          "spam_rate": 0,
          "tenant_id": "85cee693-a2e2-444a-926a-19f69db13489",
          "tenant_name": "Academia do Saber",
          "no_show_rate": 0,
          "calculated_at": "2025-08-09T06:34:19.517Z",
          "no_show_impact": 0,
          "services_count": 8,
          "churn_risk_score": 0,
          "cancellation_rate": 0,
          "total_appointments": 39,
          "total_chat_minutes": 0,
          "monthly_growth_rate": 848.4496124031008,
          "monthly_revenue_brl": 4894,
          "new_customers_count": 0,
          "professionals_count": 4,
          "no_show_appointments": 0,
          "revenue_per_customer": 128.78947368421052,
          "roi_per_conversation": 0,
          "ai_quality_by_segment": 0,
          "peak_hours_efficiency": 0,
          "response_time_average": 0,
          "trial_conversion_rate": 0,
          "unique_sessions_count": 0,
          "cancelled_appointments": 0,
          "completed_appointments": 0,
          "unique_customers_count": 0,
          "whatsapp_quality_score": 0,
          "ai_assistant_efficiency": 0,
          "customer_lifetime_value": 128.78947368421052,
          "customer_retention_rate": 0,
          "revenue_per_appointment": 125.48717948717949,
          "appointment_success_rate": 100,
          "billing_efficiency_score": 0,
          "customer_recurrence_rate": 0,
          "profit_margin_percentage": 100,
          "rescheduled_appointments": 0,
          "customer_acquisition_cost": 0,
          "intent_detection_accuracy": 0,
          "monthly_platform_cost_brl": 58,
          "platform_engagement_score": 50,
          "returning_customers_count": 1,
          "business_hours_utilization": 48.75,
          "external_appointment_ratio": 0,
          "customer_satisfaction_score": 80,
          "price_inquiry_conversations": 0,
          "appointment_duration_average": 60,
          "avg_minutes_per_conversation": 0,
          "conversation_conversion_rate": 0,
          "avg_cost_usd_per_conversation": 0,
          "avg_messages_per_conversation": 0,
          "confidence_score_distribution": 0,
          "avg_confidence_per_conversation": 0,
          "appointment_created_conversations": 0,
          "appointment_cancelled_conversations": 0,
          "info_request_fulfilled_conversations": 0
        },
        "period": "7d",
        "calculated_at": "2025-08-09T06:34:19.685+00:00",
        "created_at": "2025-08-09T06:34:19.693626+00:00",
        "updated_at": "2025-08-09T06:34:19.693626+00:00",
        "metricas_validadas": {}
      },
      "hasData": true
    },
    "platform_metrics": {
      "columns": [
        "id",
        "calculation_date",
        "period",
        "data_source",
        "comprehensive_metrics",
        "participation_metrics",
        "ranking_metrics",
        "created_at",
        "updated_at",
        "metricas_validadas"
      ],
      "sampleRow": {
        "id": "230f1834-7945-4b64-943c-aba92ed58599",
        "calculation_date": "2025-08-09",
        "period": "7d",
        "data_source": "manual_aggregation_corrected",
        "comprehensive_metrics": {
          "platform_mrr": 0,
          "total_revenue": 0,
          "active_tenants": 10,
          "total_customers": 92,
          "calculation_method": "tenant_metrics_aggregation_corrected",
          "total_appointments": 144
        },
        "participation_metrics": {},
        "ranking_metrics": {},
        "created_at": "2025-08-09T01:27:32.925109+00:00",
        "updated_at": "2025-08-09T01:27:32.925109+00:00",
        "metricas_validadas": {}
      },
      "hasData": true
    },
    "conversation_history": {
      "columns": [
        "id",
        "tenant_id",
        "user_id",
        "content",
        "is_from_user",
        "message_type",
        "intent_detected",
        "confidence_score",
        "conversation_context",
        "created_at",
        "tokens_used",
        "api_cost_usd",
        "model_used",
        "message_source",
        "processing_cost_usd",
        "conversation_outcome"
      ],
      "sampleRow": {
        "id": "9288b3a2-1063-4736-878e-bb7f6345f4f5",
        "tenant_id": "fe1fbd26-16cf-4106-9be0-390bf8345304",
        "user_id": "e905aacb-ffce-432d-b4e5-343aaee52de8",
        "content": "Oi! Quero agendar corte de cabelo",
        "is_from_user": true,
        "message_type": "text",
        "intent_detected": "booking_request",
        "confidence_score": 0.94,
        "conversation_context": {
          "session_id": "248e8d23-fa7a-4345-97f7-ec28b43cc4ac",
          "duration_minutes": 2
        },
        "created_at": "2025-07-25T18:32:00+00:00",
        "tokens_used": 44,
        "api_cost_usd": 0.0001,
        "model_used": "gpt-4",
        "message_source": "whatsapp",
        "processing_cost_usd": 0.000105,
        "conversation_outcome": null
      },
      "hasData": true
    },
    "subscription_payments": {
      "columns": [
        "id",
        "tenant_id",
        "payment_date",
        "payment_period_start",
        "payment_period_end",
        "amount",
        "currency",
        "subscription_plan",
        "payment_method",
        "payment_status",
        "stripe_payment_intent_id",
        "stripe_invoice_id",
        "payment_metadata",
        "created_at",
        "updated_at"
      ],
      "sampleRow": {
        "id": "62c6a960-8634-4315-99fe-301f97892f18",
        "tenant_id": "33b8c488-5aa9-4891-b335-701d10296681",
        "payment_date": "2025-06-15",
        "payment_period_start": "2025-06-15",
        "payment_period_end": "2025-06-30",
        "amount": 0,
        "currency": "BRL",
        "subscription_plan": "free",
        "payment_method": "trial",
        "payment_status": "completed",
        "stripe_payment_intent_id": "trial_period",
        "stripe_invoice_id": "trial_invoice",
        "payment_metadata": {
          "domain": "beauty",
          "plan_name": "Trial (15 dias)",
          "trial_days": 15,
          "tenant_name": "Bella Vista Spa & Salon",
          "trial_period": true,
          "original_plan": "profissional",
          "conversations_used": 54,
          "conversations_included": 200
        },
        "created_at": "2025-07-30T23:15:27.90596+00:00",
        "updated_at": "2025-07-30T23:15:27.90596+00:00"
      },
      "hasData": true
    }
  },
  "metricTables": [
    "tenant_metrics",
    "platform_metrics",
    "subscription_payments"
  ],
  "dataSourceTables": [
    "tenants",
    "user_tenants",
    "users",
    "appointments",
    "services",
    "professionals",
    "conversation_history",
    "subscription_payments"
  ],
  "summary": {
    "totalTables": 10,
    "tablesWithData": 10,
    "metricTables": 3,
    "dataSourceTables": 8
  }
}